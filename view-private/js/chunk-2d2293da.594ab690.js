(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2293da"],{dd37:function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("el-card",{attrs:{shadow:"never"}},[e("el-dialog",{attrs:{title:t.title,visible:t.pageVisible,width:"40%","close-on-click-modal":!1},on:{"update:visible":function(i){t.pageVisible=i}}},[e("div",{staticClass:"modal-body"},[e("el-row",{staticClass:"custom-col"},[e("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\t域名:\n\t\t\t\t\t")]),e("el-col",{attrs:{span:14}},[e("el-input",{attrs:{disabled:t.addTile},model:{value:t._$domain,callback:function(i){t._$domain=i},expression:"_$domain"}})],1)],1),e("el-row",{staticClass:"custom-col"},[e("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\tIP:\n\t\t\t\t\t")]),e("el-col",{attrs:{span:14}},[e("el-input",{attrs:{disabled:t.editTile},model:{value:t.ip,callback:function(i){t.ip=i},expression:"ip"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[e("span",{staticStyle:{color:"red"}},[t._v("* ")]),t._v(" ip 不支持ip段，仅支持单ip\n\t\t\t\t\t")])],1),e("el-row",{directives:[{name:"show",rawName:"v-show",value:"添加"===t.title,expression:"title === '添加' "}],staticClass:"custom-col"},[e("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\t时间/秒:\n\t\t\t\t\t")]),e("el-col",{attrs:{span:14}},[e("el-input",{model:{value:t.time,callback:function(i){t.time=i},expression:"time"}})],1),e("el-col",{staticStyle:{"text-align":"right"},attrs:{span:8}},[e("label",{staticStyle:{float:"right","line-height":"40px"}},[e("span",{staticStyle:{color:"red"}},[t._v("* 默认0 为永久")])])])],1),e("el-row",{staticClass:"custom-col"},[e("el-col",{attrs:{span:2}},[t._v("\n\t\t\t\t\t\t匹配动作:\n\t\t\t\t\t")]),e("el-col",{attrs:{span:14}},[e("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:t.ip_value,callback:function(i){t.ip_value=i},expression:"ip_value"}},t._l(this.$store.state.action_options,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(i){t.pageVisible=!1}}},[t._v("取 消")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:"添加"===t.title,expression:"title === '添加' "}],attrs:{type:"primary"},on:{click:function(i){t.setData("添加")}}},[t._v("添加")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:"编辑"===t.title,expression:"title === '编辑' "}],attrs:{type:"primary"},on:{click:function(i){t.setData("编辑")}}},[t._v("编辑")])],1)]),e("el-row",{staticStyle:{"margin-bottom":"20px","margin-left":"10px"},attrs:{gutter:10}},[e("div",{staticStyle:{width:"300px",float:"left"}},[e("el-input",{attrs:{"prefix-icon":"el-icon-search",placeholder:"请输入搜索内容"},model:{value:t.ruleSearch,callback:function(i){t.ruleSearch=i},expression:"ruleSearch"}})],1),e("div",{staticStyle:{float:"right"}},[e("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.showDiag}},[t._v("添加规则")]),e("el-button",{attrs:{type:"primary",size:"mini",round:""},on:{click:t.saveRule}},[t._v("保存为JSON")])],1)]),e("wafDivider"),e("el-row",{staticStyle:{"margin-top":"20px","margin-bottom":"20px","margin-left":"10px"},attrs:{gutter:10}},[e("el-col",{attrs:{span:4}},[t._v("\n\t\t\t\tip规则配置: \n\t\t\t\t"),e("el-tooltip",{attrs:{content:t.state,placement:"top"}},[e("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"on","inactive-value":"off"},on:{change:t.stateClick},model:{value:t.state,callback:function(i){t.state=i},expression:"state"}})],1)],1),e("el-col",{attrs:{span:4}},[e("span",{staticStyle:{color:"red"}},[t._v("\n\t\t\t\t\t(点击应用生效)\n\t\t\t\t")]),t._v("\n\t\t\t\t当前数量：\n\t\t\t\t"),e("i",{staticClass:"red-fonts"},[t._v("\n\t\t\t\t\t"+t._s(t.count?t.count:0)+"\n\t\t\t\t")])])],1),e("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"tooltip-effect":"dark",data:t.results}},[e("el-table-column",{attrs:{label:"域名"},scopedSlots:t._u([{key:"default",fn:function(i){return[t._v("\n\t\t\t\t\t"+t._s(i.row.host)+"\n\t\t\t\t")]}}])}),e("el-table-column",{attrs:{label:"ip"},scopedSlots:t._u([{key:"default",fn:function(i){return[t._v("\n\t\t\t\t\t"+t._s(i.row.ip)+"\n\t\t\t\t")]}}])}),e("el-table-column",{attrs:{label:"动作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(i){return[t._v("\n\t\t\t\t\t"+t._s(i.row.option)+"\n\t\t\t\t")]}}])}),e("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-button",{attrs:{type:"danger",plain:"",size:"mini"},on:{click:function(e){t.delData(i.row)}}},[e("i",{staticClass:"fa fa-close"}),t._v(" 删除")])]}}])})],1)],1)],1)},a=[],o=(e("28a5"),function(){return e.e("chunk-24bbae2e").then(e.bind(null,"0882"))}),n=function(){return e.e("chunk-321b258d").then(e.bind(null,"0777"))},l={data:function(){return{_$domain:"",ip:"",time:0,ip_value:"deny",addTile:!1,editTile:!1,ruleSearch:"",temp:[],state:"on",count:0,results:[],title:"",pageVisible:!1}},mounted:function(){this.initData()},methods:{saveRule:function(){var t=this.secReq(this.api.save2js,"post",{action:"save",mod:"ip_Mod"});t.hasOwnProperty("code")&&"ok"===t.code?this.$notify({type:"success",title:"提示",message:"应用成功",duration:1500,position:"bottom-right"}):this.$notify({type:"warning",title:"提示",message:t.msg,duration:1500,position:"bottom-right"})},initData:function(){var t=this.secReq(this.api.defIPselect,"post",{action:"get",ip:"all_ip"});if("ok"===t.code){this.count=t.msg.count,this.state=t.msg.state;var i=[];for(var e in t.msg)if("state"!==e&&"count"!==e){var s={},a=e.split("_");1==a.length?(s.host="*",s.ip=a[0]):(s.host=a[0],s.ip=a[1]),s.option=t.msg[e],i.push(s)}this.results=i,this.temp=i}else this.$notify({type:"warning",title:"提示",message:t.msg,duration:1500,position:"bottom-right"})},stateClick:function(){var t,i;"on"===this.state?(t={action:"set",mod:"base",id:"ip_Mod",value:"on"},i=this.secReq(this.api.globalConfig,"post",t),"ok"==i.code?(this.state="on",this.$notify({type:"success",title:"提示",message:"应用成功",duration:1500,position:"bottom-right"})):this.$notify({type:"warning",title:"提示",message:i.msg,duration:1500,position:"bottom-right"})):"off"===this.state&&(t={action:"set",mod:"base",id:"ip_Mod",value:"off"},i=this.secReq(this.api.globalConfig,"post",t),"ok"==i.code?(this.state="off",this.$notify({type:"success",title:"提示",message:"应用成功",duration:1500,position:"bottom-right"})):this.$notify({type:"warning",title:"提示",message:i.msg,duration:1500,position:"bottom-right"}))},delData:function(t){var i,e,s;s="*"===t.host?t.ip:t.host+"_"+t.ip,i={action:"del",ip:String(s)},e=this.secReq(this.api.defIP,"post",i),"ok"==e.code?(this.$notify({type:"success",title:"提示",message:"应用成功",duration:1500,position:"bottom-right"}),this.initData()):this.$notify({type:"warning",title:"提示",message:e.msg,duration:1500,position:"bottom-right"})},showDiag:function(){this._$domain="*",this.editTile=!1,this.time=0,this.ip="",this.ip_value="deny",this.title="添加",this.pageVisible=!0},editDiag:function(t,i){this._$domain=t.host,this.editTile=!0,this.ip=t.ip,this.ip_value=t.option,this.title="编辑",this.pageVisible=!0},setData:function(t){var i,e,s;"添加"===t?(i="*"===this._$domain?this.ip:this._$domain+"_"+this.ip,e=this.ip_value,s=this.secReq(this.api.defIP,"post",{action:"set",ip:i,time:this.time,value:e})):"编辑"===t&&(i="*"===this._$domain?this.ip:this._$domain+"_"+this.ip,e=this.ip_value,s=this.secReq(this.api.defIP,"post",{action:"set",ip:i,value:e})),"ok"===s.code?(this.$notify({type:"success",title:"提示",message:"应用成功",duration:1500,position:"bottom-right"}),this.initData()):this.$notify({type:"warning",title:"提示",message:s.msg,duration:1500,position:"bottom-right"}),this.pageVisible=!1}},filters:{},components:{wafDivider:o,wafRealipDiag:n},watch:{$route:function(t,i){},ruleSearch:{handler:function(t,i){this.results=""===t?this.temp:this.results.filter(function(i){if(i.host.indexOf(t)>=0)return!0})}}}},c=l,r=e("2877"),p=Object(r["a"])(c,s,a,!1,null,null,null);i["default"]=p.exports}}]);